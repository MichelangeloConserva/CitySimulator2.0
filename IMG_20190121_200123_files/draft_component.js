define(["require","exports","tslib","react","draft-js","spectrum_comments/comment_editor/components/readonly_draft_component","spectrum_comments/comment_editor/core/editor_component"],function(t,e,n,o,r,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollClassName="sc-comment-editor-draft",e.onChange=function(t){e.triggers.draft.change(t)},e.handleReturn=function(t,n){if(t.metaKey||t.ctrlKey){return""===n.getCurrentContent().getPlainText().trim()||e.triggers.comment.post(n),"handled"}return e.triggers.draft.returnKey(t).editorState!==n||e.status.macro.active?(t.preventDefault(),"handled"):"not-handled"},e.onScroll=function(t){if(e.status.macro.macroRef){var n=e.triggers.macro.updateVisibility,o=t.target;n(e.getMacroVisibilityFromScrollEl(o))}},e.keyBindingFn=function(t){var n=e.status.suggestion;return e.triggers.draft.key(t),e.status.suggestion!==n?(t.preventDefault(),null):r.getDefaultKeyBinding(t)},e.handleKeyCommand=function(t,n){return e.triggers.draft.keyCommand(t).editorState===n?"not-handled":"handled"},e.handleBeforeInput=function(t,n){return e.triggers.draft.input(t).editorState===n?"not-handled":"handled"},e.handlePastedText=function(t,n,o){var r=o;return r=e.triggers.draft.pasteText(t).editorState,n&&r===o&&(r=e.triggers.draft.pasteHTML({text:t,html:n}).editorState),r===o?"not-handled":"handled"},e.handleCompositionStart=function(t){e.triggers.draft.compositionStart(t)},e.handleCompositionEnd=function(t){e.triggers.draft.compositionEnd(t)},e.onKeyDown=function(t){var n=e.status.suggestion;switch(t.which){case 38:case 39:case 40:e.triggers.draft.key(t);break;case 13:if(e.status.macro.active)return void t.preventDefault()}e.status.suggestion!==n&&t.preventDefault()},e.onFocus=function(t){e.triggers.macro.updateVisibility(e.getMacroVisibilityFromScrollEl(e.getScrollEl(t.target))),e.triggers.draft.focus(t)},e.onBlur=function(t){e.triggers.macro.updateVisibility(!1),e.triggers.draft.blur(t)},e.onTab=function(t){e.triggers.draft.key(t)},e}return n.__extends(e,t),e.prototype.focusEditor=function(){this.editor.focus()},e.prototype.getMacroVisibilityFromScrollEl=function(t){if(!this.status.macro.macroRef)return!1;var e=t.getBoundingClientRect(),n=this.status.macro.macroRef.getBoundingClientRect();return n.bottom<e.bottom&&n.top>e.top},e.prototype.getScrollEl=function(t){if(null===t)throw new Error("Unable to find scroll element");return t.classList.contains(this.scrollClassName)?t:this.getScrollEl(t.parentElement)},e.prototype.componentDidUpdate=function(t){var e=t.shouldFocus;this.props.shouldFocus&&!e&&this.editor&&this.focusEditor()},e.prototype.render=function(){var t=this,e=this.status.draft,r=e.editorState,a=e.readOnly,s=e.placeholder,l=e.isComposing,d=this.props.annotation,c={readOnly:a,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,onTab:this.onTab,handleReturn:this.handleReturn,keyBindingFn:this.keyBindingFn,handleKeyCommand:this.handleKeyCommand,handleBeforeInput:this.handleBeforeInput,handlePastedText:this.handlePastedText},u=""===r.getCurrentContent().getPlainText(),g=u&&!l?o.createElement("span",{className:"sc-comment-editor-placeholder"},s):void 0;return o.createElement("div",{className:this.scrollClassName,onScroll:this.onScroll,onKeyDown:this.onKeyDown,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd},o.createElement(i.ReadonlyDraftComponent,n.__assign({draftRef:function(e){t.editor=e}},c,{annotation:d,editorPlaceholder:g})))},e})(a.EditorComponent);e.DraftComponent=s});
//# sourceMappingURL=draft_component.min.js-vflUxTcVJ.map