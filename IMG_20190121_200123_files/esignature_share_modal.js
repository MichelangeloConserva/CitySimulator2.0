define(["require","exports","tslib","esignature_prototype/api","esignature_prototype/components/esignature_utility_modals","esignature_prototype/components/esignature_share_modal/share_modal_error_message","esignature_prototype/components/esignature_share_modal/share_modal_footer","esignature_prototype/components/esignature_share_modal/share_modal_main_section","external/lodash","react","modules/clean/flux/store_listener","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/sharing/ui_util","modules/clean/sharing/stores/sharing_info","modules/clean/sharing/views/share_modal_contacts_section","modules/clean/sharing/views/share_modal_header_section","modules/clean/viewer","spectrum/modal"],function(e,t,n,a,o,r,s,i,l,c,d,u,m,g,p,h,_,f,S,M){"use strict";function E(e){var t=S.Viewer.get_viewer();return t.personal_email===e||t.work_email===e}Object.defineProperty(t,"__esModule",{value:!0}),l=n.__importStar(l),c=n.__importDefault(c);var C=function(e){var t=e.actionHandler.getSharingInfo(),a={actionHandler:e.actionHandler,contactsError:t.contactsError(),contentInfo:t.contentInfo(),initialRecipientTokens:t.initialRecipientTokens(),isTokenizerEmpty:t.isTokenizerEmpty(),recipientMessage:t.recipientMessage(),uiMode:t.uiMode()};return n.__assign({},t.getInitialProps(),a)},y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setContactsSectionRef=function(e){t.contactsSection=e},t.handleSendButtonClick=function(){var e=t.props,n=e.actionHandler,r=e.contactsError,s=e.createRequestArg,i=e.recipientMessage,d=e.sendForSignature,u=e.user,h=t.contactsSection.getContacts();n.recipientsChange(h).then(function(){if(r.level!==p.ContactsErrorLevel.Error&&h.length>0&&h[0].email){if(m.Modal.close(),E(h[0].email))return void m.Modal.showInstance(c.default.createElement(o.EsignatureCannotSendToYourselfModal,null));g.Snackbar.show(c.default.createElement(g.Snackbar,{title:"Sending for signature...",variant:"sync",key:"sending-esig-snackbar"}));var e=l.clone(s);e.recipient_emails=[h[0].email],e.recipient_message=i,a.sendSignatureRequest(e,u.id).then(function(e){g.Snackbar.close(),d(),m.Modal.showInstance(c.default.createElement(o.EsignatureSentForSignatureModal,{email:h[0].email}))}).catch(function(e){g.Snackbar.close(),m.Modal.showInstance(c.default.createElement(o.EsignatureSendForSignatureFailedModal,null))})}})},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.actionHandler,n=e.contentInfo,a=e.user,o=e.initialRecipientTokens,d=e.contactsError,u=e.recipientMessage,g=e.uiMode,p=e.isTokenizerEmpty;return c.default.createElement(M.Modal,{ariaLabel:"Esignature Sharing Modal",className:"scl-share-modal esignature-share-modal",bodyClassName:"scl-share-modal-content",overlayClassName:"esignature-modal-overlay",displayCloseButton:!1,open:!0,width:540,overlayClickClose:!0,onRequestClose:m.Modal.close},c.default.createElement(f.ShareModalHeaderSection,{actionHandler:t,contentInfo:n,canEdit:!0,isTeamSharedFolder:!1,isMetadataLoaded:!0,onModalCloseClick:m.Modal.close,onSettingsButtonClick:l.noop,onContentNameInputChange:l.noop,onContentNameInputKeyUp:l.noop,sharingInfo:t.getSharingInfo(),showPassFileSettings:!1,user:a,isSendingForSignature:!0}),c.default.createElement(_.ShareModalContactsSection,{ref:this.setContactsSectionRef,actionHandler:t,canInviteEditor:!1,canInviteViewer:!1,contentInfo:n,initialAccessLevel:"signer",initialTypeaheadTokens:o,isFolderInsideTeamFolderTree:!1,isInContentManager:!1,isTeamSharedFolder:!1,memberCountWithRecipients:0,typeaheadPlaceholder:"Email or name",user:a,isSendingForSignature:!0}),c.default.createElement(r.ShareModalErrorMessage,{error:d}),c.default.createElement(i.ShareModalMainSection,{actionHandler:t,mode:g,recipientMessage:u}),c.default.createElement(s.ShareModalFooter,{mode:g,contentInfo:n,contactsError:d,isTokenizerEmpty:p,onSendButtonClick:this.handleSendButtonClick}))},t})(c.default.Component),k=d.listenToStores(y,{sharingInfoStore:h.sharingInfoStore},C),v=u.requireCssWithComponent(k,["/static/js/spectrum-sharing/index.web-vflOj-FiO.css","/static/css/esignature_prototype/modals-vflxrQfuw.css","/static/css/react/contacts_tokenizer-vflQsfYaG.css","/static/css/scooter/scooter-scoped-vflWuydQl.css","/static/css/sharing/share_modal-vflVEEMfm.css","/static/css/modal-vflYDGbgV.css"]);t.EsignatureShareModal=v});
//# sourceMappingURL=esignature_share_modal.min.js-vflvzi-SD.map