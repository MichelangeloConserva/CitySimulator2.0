define(["require","exports","tslib","react","modules/clean/downloads","modules/clean/multiaccount_login","modules/clean/react/copy_to_dropbox/modal","modules/clean/react/modal","modules/clean/react/share_download/api","modules/clean/sharing/signup_modal_proxy","modules/clean/viewer","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify","modules/clean/react/share_download/api"],function(e,o,r,t,n,a,s,l,i,u,c,d,_,m,p,f){"use strict";function w(e){return r.__awaiter(this,void 0,void 0,function(){var o,t,a,s,l;return r.__generator(this,function(r){switch(r.label){case 0:return o=e.downloadTestUrl,t=e.url,[4,u.signupModalProxy.signupForDirectDownload()];case 1:if(r.sent(),!o)return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,i.testDownload(o)];case 3:return r.sent(),[3,5];case 4:return a=r.sent(),a instanceof f.TooLargeError?p.Notify.error(m._("The zip file is too large.")):p.Notify.error(m._("Failed to download zip file.")),[2];case 5:return r.trys.push([5,7,,8]),[4,i.fetchDownloadUrl(t)];case 6:return s=r.sent(),n.get({url:s}),[3,8];case 7:return l=r.sent(),p.Notify.error(m._("Failed to download.")),[3,8];case 8:return[2]}})})}function h(e,o,n,i){return r.__awaiter(this,void 0,void 0,function(){var m,p,f;return r.__generator(this,function(r){switch(r.label){case 0:return"anonymous"!==n?[3,2]:[4,u.signupModalProxy.signup()];case 1:return m=r.sent(),p=d.reload,[3,4];case 2:return m=i?i.id:-1,_.assert(m!==-1,"role isn't anonymous => user cannot be null or undefined!"),f=c.Viewer.get_viewer(),f.is_user_signed_in(i)?[3,4]:[4,new Promise(function(e){a.default.show_modal({role:n,on_success:e})})];case 3:r.sent(),r.label=4;case 4:return l.Modal.showInstance(t.default.createElement(s.CopyToDropboxModal,{shareToken:e,copyable:o,userId:m,role:n,onDismiss:p})),[2]}})})}Object.defineProperty(o,"__esModule",{value:!0}),t=r.__importDefault(t),n=r.__importStar(n),a=r.__importDefault(a),i=r.__importStar(i),d=r.__importStar(d),o.direct=w,o.toDropbox=h});
//# sourceMappingURL=actions.min.js-vfl193Htn.map