define(["require","exports","tslib","modules/clean/auth_event_logger","modules/clean/dbmodal","modules/clean/react/file_comments/logger","modules/constants/comments_panel","modules/core/browser","modules/core/i18n","modules/core/notify"],function(t,e,i,o,n,r,s,_,l,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r=i.__importDefault(r),_=i.__importStar(_);var u=(function(){function t(){this.init_modals=this.init_modals.bind(this),this.hide_modal=this.hide_modal.bind(this),this.show_sign_up_modal=this.show_sign_up_modal.bind(this),this.show_sign_in_modal=this.show_sign_in_modal.bind(this),this.before_modal=this.before_modal.bind(this),this._reload=this._reload.bind(this),this._prepare_form=this._prepare_form.bind(this),this._toggle_form=this._toggle_form.bind(this),this.show_register=!1,this.init_modals()}return t.initClass=function(){this.POST_COMMENT_VARIANT="post_comment_variant",this.SUBSCRIBE_VARIANT="subscribe_variant"},t.createInstance=function(){return new t},t.prototype.init_modals=function(){return this.default_signup_modal=new n.DBModal({element_id:"shared-link-default-comments-signup-modal"}),this.default_signup_modal.before_show=this.before_modal},t.prototype.hide_modal=function(){return this.default_signup_modal.hide()},t.prototype.show_sign_up_modal=function(t){return this.show_register=!0,this.variant=t,this.default_signup_modal.show()},t.prototype.show_sign_in_modal=function(t){return this.show_register=!1,this.variant=t,this.default_signup_modal.show()},t.prototype.set_activity_key=function(t){return this.activity_key=t},t.prototype.before_modal=function(t){var e=this;this._prepare_form(t),t.find(".toggle-form-link").click(function(){return e._toggle_form(t)});var i=t.find(".register-form");i.length&&i.on("db:register:success",function(t,i){return e.user=i,a.Notify.success(l._("Successfully signed up for Dropbox")),r.default.log_event(s.FILE_ACTIVITY_LOG_EVENT_TYPE.CLIENT_SIGN_UP_SUCCESS,e.activity_key,null,null,e.user.id),e._reload()});var o=t.find(".login-form");if(o.length)return i.length&&i.on("db:register:user_exists",function(i){e._toggle_form(t);for(var n=0;n<i.prefill.length;n++){var r=i.prefill[n];o.find(r).val(n)}return o.find(i.focus).focus()}),o.on("db:login:success",function(t,i){return e.user=i,a.Notify.success(l._("Successfully signed in to Dropbox")),r.default.log_event(s.FILE_ACTIVITY_LOG_EVENT_TYPE.CLIENT_SIGN_IN_SUCCESS,e.activity_key,null,null,e.user.id),e._reload()})},t.prototype._reload=function(){return _.reload()},t.prototype._prepare_form=function(e){switch(e.find(".form-component").hide(),e.find(".text-variant").hide(),this.show_register?e.find(".register-form-component").show():e.find(".login-form-component").show(),this.variant){case t.POST_COMMENT_VARIANT:return e.find(".text-variant.post-comment-variant").show();case t.SUBSCRIBE_VARIANT:return e.find(".text-variant.subscribe-variant").show();default:return e.find(".text-variant.default-variant").show()}},t.prototype._toggle_form=function(t){var e,i=t.find(".register-form-component"),n=t.find(".login-form-component");return i.is(":visible")?(o.AuthEventLogger.log_web_login_intent(),e=s.FILE_ACTIVITY_LOG_EVENT_TYPE.CLIENT_SIGN_IN_MODAL,i.fadeOut({complete:function(){return n.show()}})):(e=s.FILE_ACTIVITY_LOG_EVENT_TYPE.CLIENT_SIGN_UP_MODAL,n.fadeOut({complete:function(){return i.show()}})),r.default.log_event(e,this.activity_key,null,s.FILE_ACTIVITY_LOG_CLIENT_ORIGIN_TYPE.MODAL_TOGGLE_BUTTON)},t})();e.CommentsSharedLinkSignupModals=u,u.initClass()});
//# sourceMappingURL=shared_link_signup_modals.min.js-vflw42hGv.map